<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Zachary Colburn" />

<meta name="date" content="2018-01-21" />

<title>Bioi</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Bioi</h1>
<h4 class="author"><em>Zachary Colburn</em></h4>
<h4 class="date"><em>2018-01-21</em></h4>



<p>Bioi provides functions to perform connected component labeling on 1, 2, or 3 dimensional arrays, single linkage clustering, and identification of the nearest neighboring point in a second data set.</p>
<section id="determine-the-minimum-separation-distance-between-two-sets-of-points" class="level1">
<h1>Determine the minimum separation distance between two sets of points</h1>
<p>Dual channel PALM or iPALM data can represent the localizations of two distinct fluorophore-labeled proteins. To determine the minimum distance separating each localization of protein A from protein B, the following code could be implemented. Each row in the output of find_min_dists corresponds to the point denoted by the same row in mOne. “dist” is the distance to the nearest point in mTwo, whose row number in mTwo is given in the “index” column.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(Bioi)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co"># Generate two data sets to simulate 3D PALM data.</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">mOne &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  <span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dv">10</span>),</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  <span class="dt">y =</span> <span class="kw">rbinom</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  <span class="dt">z =</span> <span class="kw">runif</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">))</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">mTwo &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">  <span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dv">20</span>),</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">  <span class="dt">y =</span> <span class="kw">rbinom</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb1-15" data-line-number="15">  <span class="dt">z =</span> <span class="kw">runif</span>(<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">))</a>
<a class="sourceLine" id="cb1-17" data-line-number="17"></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co"># Get separation distances.</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="kw">find_min_dists</span>(mOne, mTwo)</a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt;         dist index</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt; 1  2.1030934    11</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt; 2  0.1711268    12</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt; 3  1.0770476     9</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt; 4  2.3690046     4</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#&gt; 5  0.6385089    12</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="co">#&gt; 6  1.5313912    15</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#&gt; 7  0.4466117    16</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">#&gt; 8  0.8946710    10</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co">#&gt; 9  1.4894504    13</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co">#&gt; 10 0.5430501    15</span></a></code></pre></div>
</section>
<section id="single-linkage-clustering" class="level1">
<h1>Single linkage clustering</h1>
<p>PALM/iPALM localizations in very close proximity may belong to the same superstructure, for example a single focal adhesion. By linking localizations separated by less than some empirically determined distance, these different super structures can be identified. Below, 2D PALM data is simulated and all points falling within a distance of 0.8 are linked.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Generate random data.</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">input &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">rnorm</span>(<span class="dv">10</span>),<span class="dt">y=</span><span class="kw">rnorm</span>(<span class="dv">10</span>)))</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co"># Perform clustering.</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">groups &lt;-<span class="st"> </span><span class="kw">euclidean_linker</span>(input, <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; ||==================================================||</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; ||..................................................||</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="kw">print</span>(groups)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt;  [1] 3 3 2 3 3 3 2 3 1 3</span></a></code></pre></div>
<p>Clusters can be easily visualized using ggplot2.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">input &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(input)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">input<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">as.character</span>(groups)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw">ggplot</span>(input, <span class="kw">aes</span>(x, y, <span class="dt">colour =</span> group)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>)</a></code></pre></div>
</section>
<section id="label-connected-components-i.e.find-contiguous-blobs" class="level1">
<h1>Label connected components (i.e. find contiguous blobs)</h1>
<p>Following background subtraction and thresholding, distinct cellular structures (focal adhesions for example) can be identified in fluorescent microscopy images. Array elements that are connected horizontally/vertically or diagonally are labeled with the same group number. Each contiguous object is labeled with a different group number. The function find_blobs can be used to implement this functionality in 1, 2, or 3 dimensions. Below, this operations is performed on a matrix structure.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Generate a random matrix.</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">70</span>), <span class="dt">nrow =</span> <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co"># Arbitrarily say that everything below 0.8 is background.</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">logical_mat &lt;-<span class="st"> </span>mat <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.8</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co"># Row names and column names are preserved in the output of find_blobs</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="kw">rownames</span>(logical_mat) &lt;-<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>]</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="kw">colnames</span>(logical_mat) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co"># Find blobs</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="kw">find_blobs</span>(logical_mat)</a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; ||==================================================||</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; ||..................................................||</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt;    1  2  3  4  5  6  7  8  9 10</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; a NA NA NA NA NA NA NA  3 NA NA</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt; b NA NA NA NA NA  2 NA NA NA  5</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; c NA NA NA NA NA  2 NA  4 NA NA</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt; d NA NA NA NA NA NA NA NA NA NA</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; e NA NA NA NA NA NA NA NA NA NA</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; f NA NA  1  1  1 NA NA NA NA NA</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; g NA NA  1 NA NA NA NA NA NA NA</span></a></code></pre></div>
</section>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
